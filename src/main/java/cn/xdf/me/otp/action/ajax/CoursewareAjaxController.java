package cn.xdf.me.otp.action.ajax;import javax.servlet.http.HttpServletRequest;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.context.annotation.Scope;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import org.springframework.web.bind.annotation.ResponseBody;import org.springframework.web.multipart.MultipartFile;import org.springframework.web.multipart.MultipartHttpServletRequest;import org.springframework.web.multipart.commons.CommonsMultipartResolver;import cn.xdf.me.otp.action.view.model.VOperation;import cn.xdf.me.otp.service.flow.BamCoursewareItemService;/** * 修改课件状态及上传课件 *  * @author Zaric * @date 2013-6-1 上午12:30:48 */@Controller@RequestMapping(value = "/ajax/courseware")@Scope("request")public class CoursewareAjaxController {	@Autowired	private BamCoursewareItemService bamCoursewareItemService;	@RequestMapping(value = "setUpload", method = RequestMethod.POST)	@ResponseBody	public VOperation setUpload(HttpServletRequest request) {		// 上传		String key = request.getParameter("itemId");		String fdFileName = request.getParameter("filename");		String fdFullName = request.getParameter("fullname");		// 返回部署路径		CommonsMultipartResolver commonsMultipartResolver = new CommonsMultipartResolver(				request.getSession().getServletContext());		commonsMultipartResolver.setDefaultEncoding("utf-8");		MultipartHttpServletRequest multipartRequest = (MultipartHttpServletRequest) request;		MultipartFile file = multipartRequest.getFile("Filedata");		VOperation vOperation = bamCoursewareItemService.uploadCourseware(key,				fdFileName, fdFullName, file, request, 1);		return vOperation;	}	@RequestMapping(value = "setData", method = RequestMethod.POST)	@ResponseBody	public String setThrough(HttpServletRequest request) {		// 提交		String key = request.getParameter("itemId");		String fdFileName = request.getParameter("fileName");		String fdFullName = request.getParameter("fullName");		String isSucc = bamCoursewareItemService.submitCourseware(key,				fdFileName, fdFullName, 2);		return isSucc;	}}